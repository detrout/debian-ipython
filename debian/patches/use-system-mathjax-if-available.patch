From: Julian Taylor <jtaylor.debian@googlemail.com>
Date: Sun, 18 Dec 2011 14:04:29 +0100
Subject: use system mathjax if available

---
 IPython/frontend/html/notebook/notebookapp.py |   10 +++++++++-
 1 files changed, 9 insertions(+), 1 deletions(-)

--- a/IPython/frontend/html/notebook/notebookapp.py
+++ b/IPython/frontend/html/notebook/notebookapp.py
@@ -105,6 +105,11 @@
             (r"/notebooks/%s" % _notebook_id_regex, NotebookHandler),
             (r"/rstservice/render", RSTHandler)
         ]
+
+        if os.path.exists("/usr/share/javascript/mathjax/MathJax.js"):
+          handlers.append((r"/mathjax/(.*)", web.StaticFileHandler,
+                           {"path": "/usr/share/javascript/mathjax"}))
+
         settings = dict(
             template_path=os.path.join(os.path.dirname(__file__), "templates"),
             static_path=os.path.join(os.path.dirname(__file__), "static"),
@@ -284,6 +289,9 @@
         if os.path.exists(os.path.join(static_path, 'mathjax', "MathJax.js")):
             self.log.info("Using local MathJax")
             return u"static/mathjax/MathJax.js"
+        elif os.path.exists("/usr/share/javascript/mathjax/MathJax.js"):
+            self.log.info("Using system MathJax")
+            return u"mathjax/MathJax.js"
         else:
             self.log.info("Using MathJax from CDN")
             return u"http://cdn.mathjax.org/mathjax/latest/MathJax.js"
